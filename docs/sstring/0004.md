---
outline: deep
---

# KMP 算法

手算next

|      序号      | 1    | 2    | 3    | 4    | 5    | 6    |
| :------------: | ---- | ---- | ---- | ---- | ---- | ---- |
|      模式      | a    | b    | a    | a    | b    | c    |
| 最大公共前后缀 | 0    | 0    | 0    | 1    | 1    | 2    |
|    next数组    | 0    | 1    | 1    | 2    | 2    | 3    |
|  nextval数组   | 0    | 1    | 0    | 2    | 1    | 3    |

next 数组求法：除1号位其他为最大公共前后缀+1

**求解公共前后缀**

序号1之前没有公共前后缀最大位0

序号2之前`a`没有公共前后缀最大位0

序号3之前`ab`没有公共前后缀最大位0

序号4之前`aba`公共前后缀`a`最大位1

序号5之前`abaa`公共前后缀`a`最大位1

序号6之前`abab`公共前后缀`ab`最大位2

公共前后缀为[0,0,0,1,1,2]

**求解next 数组**

除1号位其他为最大公共前后缀+1

next数组为[0,1,1,2,2,3]

**求解nextval数组**

nextval的值从next而来

|      序号      | 1     | 2     | 3          | 4     | 5          | 6     |
| :------------: | ----- | ----- | ---------- | ----- | ---------- | ----- |
|      模式      | a     | b     | a          | a     | b          | c     |
| 最大公共前后缀 | 0     | 0     | 0          | 1     | 1          | 2     |
|    next数组    | 0     | 1     | 1          | 2     | 2          | 3     |
|  nextval数组   | 直写0 | 直写1 | 序号1的值0 | 直写2 | 序号2的值1 | 直写3 |

序号1的next数组为0，而0没有对应的序号，值为0

序号2的next数组值为1，而1对应的模式与2对应的模式a≠b,直接写下next的值1

序号3的next数组值为1，而1对应的模式与3对应的模式a=a,写下序号1对应的next值0

序号4的next数组值为2，而2对应的模式与4对应的模式b≠a,直接写下next的值2

序号5的next数组值为2，而2对应的模式与5对应的模式b=b,写下序号2对应的next值1

序号6的next数组值为3，而3对应的模式与6对应的模式a≠c,直接写下next的值3

